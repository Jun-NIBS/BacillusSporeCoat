BceClade0 = clades[grep("Bce|Bwe|Ban|Bth", clades)]
BceClade = BceClade0[ - grep( "Bsu|Bpu|Bam|Bli|Bmo", BceClade0) ]
BceClade
BceClade11
match(sort(BceClade), sort(BceClade11))
match(sort(BsuClade), sort(BsuClade11))
nonCE.tb$flag = NA;
coat.tb$flag  = NA;
for( j in 1:length(BsuClade)){
nonCE.tb$flag[ nonCE.tb$V3 == BsuClade[j] ] = 'bsu';
coat.tb$flag[ coat.tb$V2==BsuClade[j] ]     = 'bsu';
}
for( j in 1:length(BceClade)){
nonCE.tb$flag[ nonCE.tb$V3 == BceClade[j] ] = 'bce';
coat.tb$flag[ coat.tb$V2==BceClade[j] ]     = 'bce';
}
table( coat.tb$V2, coat.tb$flag) #check flags
table(coat.tb$node, coat.tb$flag) #check flags
head(coat.tb)
head(nonCE.tb)
#2013 Jan 13, compare free omega bw coat and nonCE after GBlocks
# Nov 29, 2011,  partition between <1, >1,
# 051411 add coat profile
# I will partion Bsu, Bce-clade omegas, wilcox.test in coat proteins and between coat and nonCE protein
##########################################
rm(list=ls());
## some test to demonstrate the syntax for alternative hypothesis
#x = rnorm(100)+5
#y = x + 2
#summary(x);
#summary(y)
#wilcox.test( x, y, alt='gr') #accept null, large p
#wilcox.test( x, y, alt='less') #reject null, accept alternative, small p
## coat gene profile
ctb = read.table( "_coat.profile.122908.csv",sep="\t",header=T);
ctb$id = as.character( ctb$id );
row.names( ctb ) = as.character( ctb$id );
bacillus.specs = names(ctb)[10:20];
ctb2 = ctb[,c(1,10:20)]
ctb3 = ctb2[, 2:12] #profile matrix
ctb3 = ifelse( is.na(ctb3), 0, 1);
ctb3 = data.frame(ctb3);
#head(ctb3); #passed
ctb3$cereushits = ctb3$Ban + ctb3$Bth + ctb3$Bce + ctb3$Bwe
ctb3$subtilishits = ctb3$Bam + ctb3$Bli + ctb3$Bpu
ctb3$outhits = ctb3$Bha + ctb3$Bcl
ctb3$hits = ctb3$cereushits + ctb3$subtilishits + ctb3$outhits;
#hist(ctb3$cereushits)
### coat free omega, and match to coat orthologous hits in the profile table
coat11.tb = read.delim("_free.omega.coat.paml.Jan20,2011.txt", header=F);
coat.tb = read.delim("_free.omega.GBlocked.coat.paml.Jan17,2013.txt", header=F); #20130123
coat.tb = coat.tb[ ! is.na(coat.tb$V4), ]
coat.tb$V2 = as.character(coat.tb$V2)
coat.tb$V1 = as.character(coat.tb$V1)
positions = match( coat.tb$V1, rownames(ctb3))
#ctb3[positions[1:5], ] #check, passed
coat.tb = cbind( coat.tb, ctb3[positions, c('cereushits','subtilishits', 'outhits', 'hits')])
#head(coat.tb)
positions = match( coat.tb$V1, ctb$id)
coat.tb$CoatLocation = ctb$CoatLocation[positions]
coat.tb$node = "internal"
coat.tb$node[grep("^B", coat.tb$V2)] = "leaf"
head(coat.tb)
unique(coat.tb$CoatLocation)
### nonCE free omega
nonCE11.tb = read.delim("_nonCE.omega.7March2011.tab", header=F); #2011 results, without GBlocks
nonCE11.tb = nonCE11.tb[nonCE11.tb$V2=='H1C',] # H1C is where free omega are calculated
head(nonCE11.tb)
nonCE.tb = read.delim("_nonCE.omega.2013Jan23.tab", header=F); #20130123, after GBlocks
nonCE.tb = nonCE.tb[nonCE.tb$V2=='H1C',] # H1C is where free omega are calculated
nonCE.tb$V3 = as.character(nonCE.tb$V3)
nonCE.tb$node = "internal"
nonCE.tb$node[grep("^B", nonCE.tb$V3)] = "leaf"
head(nonCE.tb)
#compare nonCE w be and afer GBlocks
summary(nonCE11.tb$V11)
summary(nonCE.tb$V11)
t.test( nonCE11.tb$V11, nonCE.tb$V11)
hist(nonCE11.tb$V11)
hist(nonCE.tb$V11)
#how much w > 1, 999
quantile( nonCE.tb$V11, prob=c(0.2, 0.5, 0.8,0.83, 0.85, 0.86, 0.87, 0.88, 0.9))
quantile( coat.tb$V10, prob=c(0.2, 0.5, 0.8,0.815, 0.82, 0.83, 0.85, 0.86, 0.87, 0.88, 0.9))
#remove 999s Many labile coat genes have omega=999??
#Wcutoff = 998
#coat.tb$V10[coat.tb$V10> Wcutoff ] = NA
#nonCE.tb$V11[nonCE.tb$V11> Wcutoff ] = NA
#### parse the omega results
clades = unique(c( nonCE.tb$V3, coat.tb$V2))  #35 clades
BsuClade0 = clades[ grep( "Bsu|Bpu|Bam|Bli|Bmo", clades)]; #20130123
BsuClade = BsuClade0[- grep("Bce|Bwe|Ban|Bth", BsuClade0)]
BceClade0 = clades[grep("Bce|Bwe|Ban|Bth", clades)]
BceClade = BceClade0[ - grep( "Bsu|Bpu|Bam|Bli|Bmo", BceClade0) ]
BsuClade11 = c("(Bpu,Bli,Bam,Bsu)","(Bli,Bam,Bsu)","(Bpu,Bli,Bsu)", "Bpu", "Bli", "(Bam,Bsu)", "Bam", "Bsu", "(Bpu,Bam,Bsu)",
"(Bpu,Bli,Bam,Bmo,Bsu)", "(Bli,Bam,Bmo,Bsu)", "(Bam,Bmo,Bsu)","(Bmo,Bsu)","Bmo","(Bli,Bam,Bsu,Bmo)", "(Bam,Bsu,Bmo)", "(Bsu,Bmo)",
"(Bpu,Bam,Bmo,Bsu)", "(Bli,Bmo,Bsu)", "(Bli,Bsu)" );
BceClade11 = c("(Bwe,Bce,Ban,Bth)","(Bce,Ban,Bth)","(Ban,Bth)","(Bwe,Bce,Bth)","(Bce,Bth)", "(Bwe,Ban,Bth)",
"Bwe","Ban","Bth","Bce");
match(sort(BceClade), sort(BceClade11)) #20130123, 2013 and 2011 gave exactly the same branchs. YES.
match(sort(BsuClade), sort(BsuClade11))
nonCE.tb$flag = NA;
coat.tb$flag  = NA;
for( j in 1:length(BsuClade)){
nonCE.tb$flag[ nonCE.tb$V3 == BsuClade[j] ] = 'bsu';
coat.tb$flag[ coat.tb$V2==BsuClade[j] ]     = 'bsu';
}
for( j in 1:length(BceClade)){
nonCE.tb$flag[ nonCE.tb$V3 == BceClade[j] ] = 'bce';
coat.tb$flag[ coat.tb$V2==BceClade[j] ]     = 'bce';
}
table( coat.tb$V2, coat.tb$flag) #check flags
table(coat.tb$node, coat.tb$flag) #check flags
head(coat.tb)
head(nonCE.tb)
BsuClade
wilcox.test( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'],
nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'],
alternative='gr') #
coat.tb$V10[coat.tb$node=='internal' & coat.tb$flag=='bsu']
head(coat.tb)
head(nonCE.tb)
BsuClade
BceClade
wilcox.test( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'],
nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'],
alternative='gr') #
summary( nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'] )
summary( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'] )
BceClade
wilcox.test( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bce'],
nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bce'],
alternative='gr') #
summary( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bce'] )
summary( nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bce'] )
wilcox.test( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1 ],
nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu' & nonCE.tb$V11<1],
alternative='gr') #
summary( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1 ] )
summary( nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu' & nonCE.tb$V11<1 ] )
coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1 ]
coat.tb[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1,  ]
coat.tb[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1, 1:10 ]
View(coat.tb)
coat.tb[coat.tb$node=='internal' & coat.tb$flag=='bsu' & coat.tb$V10<1, ]
head(coat.tb)
head(nonCE.tb)
BsuClade
wilcox.test( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'],
nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'],
alternative='gr') #
summary( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'] )
summary( nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'] )
## some test to demonstrate the syntax for alternative hypothesis
x = rnorm(100)+5
y = x + 2
#summary(x);
#summary(y)
wilcox.test( x, y, alt='gr') #accept null, large p
wilcox.test( x, y, alt='less') #reject null, accept alternative, small p
wilcox.test( y, x, alt='gr') #accept alter, small p
# remove overly high omegas
#remove 999s Many labile coat genes have omega=999??
Wcutoff = 10
coat.tb$V10[coat.tb$V10> Wcutoff ] = NA
nonCE.tb$V11[nonCE.tb$V11> Wcutoff ] = NA
#### parse the omega results
clades = unique(c( nonCE.tb$V3, coat.tb$V2))  #35 clades
BsuClade0 = clades[ grep( "Bsu|Bpu|Bam|Bli|Bmo", clades)]; #20130123
BsuClade = BsuClade0[- grep("Bce|Bwe|Ban|Bth", BsuClade0)]
BceClade0 = clades[grep("Bce|Bwe|Ban|Bth", clades)]
BceClade = BceClade0[ - grep( "Bsu|Bpu|Bam|Bli|Bmo", BceClade0) ]
BsuClade11 = c("(Bpu,Bli,Bam,Bsu)","(Bli,Bam,Bsu)","(Bpu,Bli,Bsu)", "Bpu", "Bli", "(Bam,Bsu)", "Bam", "Bsu", "(Bpu,Bam,Bsu)",
"(Bpu,Bli,Bam,Bmo,Bsu)", "(Bli,Bam,Bmo,Bsu)", "(Bam,Bmo,Bsu)","(Bmo,Bsu)","Bmo","(Bli,Bam,Bsu,Bmo)", "(Bam,Bsu,Bmo)", "(Bsu,Bmo)",
"(Bpu,Bam,Bmo,Bsu)", "(Bli,Bmo,Bsu)", "(Bli,Bsu)" );
BceClade11 = c("(Bwe,Bce,Ban,Bth)","(Bce,Ban,Bth)","(Ban,Bth)","(Bwe,Bce,Bth)","(Bce,Bth)", "(Bwe,Ban,Bth)",
"Bwe","Ban","Bth","Bce");
match(sort(BceClade), sort(BceClade11)) #20130123, 2013 and 2011 gave exactly the same branchs. YES.
match(sort(BsuClade), sort(BsuClade11))
nonCE.tb$flag = NA;
coat.tb$flag  = NA;
for( j in 1:length(BsuClade)){
nonCE.tb$flag[ nonCE.tb$V3 == BsuClade[j] ] = 'bsu';
coat.tb$flag[ coat.tb$V2==BsuClade[j] ]     = 'bsu';
}
for( j in 1:length(BceClade)){
nonCE.tb$flag[ nonCE.tb$V3 == BceClade[j] ] = 'bce';
coat.tb$flag[ coat.tb$V2==BceClade[j] ]     = 'bce';
}
table( coat.tb$V2, coat.tb$flag) #check flags
table(coat.tb$node, coat.tb$flag) #check flags
head(coat.tb)
head(nonCE.tb)
BsuClade
wilcox.test( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'],
nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'],
alternative='gr') #
summary( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'] )
summary( nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'] )
head(nonCE.tb)
unique(nonCE.tb$V1)
nonCE.tb = read.delim("_nonCE.omega.2013Jan23.tab", header=F); #20130123, after GBlocks
nonCE.tb = nonCE.tb[nonCE.tb$V2=='H1C',] # H1C is where free omega are calculated
nonCE.tb = nonCE.tb[-grep("^#", nonCE.tb$V1) , ]
nonCE.tb$V3 = as.character(nonCE.tb$V3)
nonCE.tb$node = "internal"
nonCE.tb$node[grep("^B", nonCE.tb$V3)] = "leaf"
head(nonCE.tb)
grep("#", nonCE.tb$V1)
nonCE.tb = read.delim("_nonCE.omega.2013Jan23.tab", header=F); #20130123, after GBlocks
nonCE.tb = nonCE.tb[nonCE.tb$V2=='H1C',] # H1C is where free omega are calculated
grep("#", nonCE.tb$V1)
str(nonCE.tb$V1)
nonCE.tb = read.delim("_nonCE.omega.2013Jan23.tab", header=F); #20130123, after GBlocks
nonCE.tb$V1 = as.character( nonCE.tb$V1 )
nonCE.tb$V2 = as.character( nonCE.tb$V2 )
nonCE.tb = nonCE.tb[nonCE.tb$V2=='H1C',] # H1C is where free omega are calculated
nonCE.tb = nonCE.tb[- grep("#", nonCE.tb$V1) , ]
nonCE.tb$V3 = as.character(nonCE.tb$V3)
nonCE.tb$node = "internal"
nonCE.tb$node[grep("^B", nonCE.tb$V3)] = "leaf"
head(nonCE.tb)
nonCE.tb = read.delim("_nonCE.omega.2013Jan23.tab", header=F); #20130123, after GBlocks
nonCE.tb$V1 = as.character( nonCE.tb$V1 )
nonCE.tb$V2 = as.character( nonCE.tb$V2 )
nonCE.tb = nonCE.tb[nonCE.tb$V2=='H1C',] # H1C is where free omega are calculated
str(nonCE.tb)
grep("#", nonCE.tb$V1)
grep("BG", nonCE.tb$V1)
grep("Group", nonCE.tb$V1)
nonCE.tb = read.delim("_nonCE.omega.2013Jan23.tab", header=F); #20130123, after GBlocks
nonCE.tb$V1 = as.character( nonCE.tb$V1 )
nonCE.tb$V2 = as.character( nonCE.tb$V2 )
nonCE.tb = nonCE.tb[nonCE.tb$V2=='H1C',] # H1C is where free omega are calculated
#nonCE.tb = nonCE.tb[- grep("#", nonCE.tb$V1) , ]
nonCE.tb$V3 = as.character(nonCE.tb$V3)
nonCE.tb$node = "internal"
nonCE.tb$node[grep("^B", nonCE.tb$V3)] = "leaf"
head(nonCE.tb)
str(nonCE.tb)
unique(nonCE.tb$V1)
length(unique(nonCE.tb$V1))
length(unique(coat.tb$V1))
unique(coat.tb$V1)
BsuClade
summary( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'] )
summary( nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'] )
wilcox.test( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'],
nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'],
alternative='gr') #
nonCE.tb = read.delim("_nonCE.omega.2013Jan23.tab", header=F); #20130123, after GBlocks
nonCE.tb$V1 = as.character( nonCE.tb$V1 )
nonCE.tb$V2 = as.character( nonCE.tb$V2 )
nonCE.tb = nonCE.tb[nonCE.tb$V2=='H1C',] # H1C is where free omega are calculated
#nonCE.tb = nonCE.tb[- grep("#", nonCE.tb$V1) , ]
nonCE.tb$V3 = as.character(nonCE.tb$V3)
nonCE.tb$node = "internal"
nonCE.tb$node[grep("^B", nonCE.tb$V3)] = "leaf"
head(nonCE.tb)
str(nonCE.tb)
#compare nonCE w be and afer GBlocks
summary(nonCE11.tb$V11)
summary(nonCE.tb$V11)
t.test( nonCE11.tb$V11, nonCE.tb$V11)
hist(nonCE11.tb$V11)
hist(nonCE.tb$V11)
#how much w > 1, 999
quantile( nonCE.tb$V11, prob=c(0.2, 0.5, 0.8,0.83, 0.85, 0.86, 0.87, 0.88, 0.9))
quantile( coat.tb$V10, prob=c(0.2, 0.5, 0.8,0.815, 0.82, 0.83, 0.85, 0.86, 0.87, 0.88, 0.9))
# remove overly high omegas
#remove 999s Many labile coat genes have omega=999??
Wcutoff = 10
coat.tb$V10[coat.tb$V10> Wcutoff ] = NA
nonCE.tb$V11[nonCE.tb$V11> Wcutoff ] = NA
#### parse the omega results
clades = unique(c( nonCE.tb$V3, coat.tb$V2))  #35 clades
BsuClade0 = clades[ grep( "Bsu|Bpu|Bam|Bli|Bmo", clades)]; #20130123
BsuClade = BsuClade0[- grep("Bce|Bwe|Ban|Bth", BsuClade0)]
BceClade0 = clades[grep("Bce|Bwe|Ban|Bth", clades)]
BceClade = BceClade0[ - grep( "Bsu|Bpu|Bam|Bli|Bmo", BceClade0) ]
BsuClade11 = c("(Bpu,Bli,Bam,Bsu)","(Bli,Bam,Bsu)","(Bpu,Bli,Bsu)", "Bpu", "Bli", "(Bam,Bsu)", "Bam", "Bsu", "(Bpu,Bam,Bsu)",
"(Bpu,Bli,Bam,Bmo,Bsu)", "(Bli,Bam,Bmo,Bsu)", "(Bam,Bmo,Bsu)","(Bmo,Bsu)","Bmo","(Bli,Bam,Bsu,Bmo)", "(Bam,Bsu,Bmo)", "(Bsu,Bmo)",
"(Bpu,Bam,Bmo,Bsu)", "(Bli,Bmo,Bsu)", "(Bli,Bsu)" );
BceClade11 = c("(Bwe,Bce,Ban,Bth)","(Bce,Ban,Bth)","(Ban,Bth)","(Bwe,Bce,Bth)","(Bce,Bth)", "(Bwe,Ban,Bth)",
"Bwe","Ban","Bth","Bce");
match(sort(BceClade), sort(BceClade11)) #20130123, 2013 and 2011 gave exactly the same branchs. YES.
match(sort(BsuClade), sort(BsuClade11))
nonCE.tb$flag = NA;
coat.tb$flag  = NA;
for( j in 1:length(BsuClade)){
nonCE.tb$flag[ nonCE.tb$V3 == BsuClade[j] ] = 'bsu';
coat.tb$flag[ coat.tb$V2==BsuClade[j] ]     = 'bsu';
}
for( j in 1:length(BceClade)){
nonCE.tb$flag[ nonCE.tb$V3 == BceClade[j] ] = 'bce';
coat.tb$flag[ coat.tb$V2==BceClade[j] ]     = 'bce';
}
table( coat.tb$V2, coat.tb$flag) #check flags
table(coat.tb$node, coat.tb$flag) #check flags
#2013 for updated table
head(coat.tb)
head(nonCE.tb)
length(unique(nonCE.tb$V1)) #2085 genes
length(unique(coat.tb$V1)) #47 genes
BsuClade
summary( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'] )
summary( nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'] )
wilcox.test( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'],
nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'],
alternative='gr') #
summary( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu'] )
summary( nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu'] )
coat.tb[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1, 1:10 ]
nonCE.tb[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu' & nonCE.tb$V11<1, 1:10]
coat.tb[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1 [1:10], ]
coat.tb[(coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1 )[1:10], ]
coat.tb[(coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1 )[1:2], ]
coat.tb[(coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1 ), ]
head(nonCE.tb[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu' & nonCE.tb$V11<1,])
head(coat.tb[(coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1 ), ] )
summary( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1 ] )
summary( nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu' & nonCE.tb$V11<1 ] )
wilcox.test( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10<1 ],
nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu' & nonCE.tb$V11<1],
alternative='gr') #
summary( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10 > 1 ] )
summary( nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu' & nonCE.tb$V11 > 1 ] )
wilcox.test( coat.tb$V10[coat.tb$node=='leaf' & coat.tb$flag=='bsu' & coat.tb$V10 > 1 ],
nonCE.tb$V11[nonCE.tb$node=='leaf' & nonCE.tb$flag=='bsu' & nonCE.tb$V11 > 1],
alternative='gr') #
nodechoice = 'internal'; cladechoice = 'bsu';
BsuClade
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag=='bsu'] )
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag=='bsu'] )
wilcox.test( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag=='bsu'],
nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag=='bsu'],
alternative='gr') #
nodechoice = 'internal'; cladechoice = 'bsu';
BsuClade
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice] )
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice] )
wilcox.test( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice],
nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice],
alternative='gr') #
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10<1 ), ] )
head(nonCE.tb[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11<1,])
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice] )
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice] )
wilcox.test( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice],
nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice],
alternative='gr') #
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice  & nonCE.tb$V11<1 ] )
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10<1 ] )
wilcox.test( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice  & coat.tb$V10<1 ],
nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11<1],
alternative='gr') #
head(nonCE.tb[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11 > 1,])
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ), ] )
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11 > 1 ] )
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ] )
wilcox.test( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ],
nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11 > 1],
alternative='gr') #
##################
### leaf node in BceClade
nodechoice = 'leaf'; cladechoice = 'bce';
BceClade
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10<1 ), ] )
head(nonCE.tb[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11<1,])
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice] )
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice] )
wilcox.test( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice],
nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice],
alternative='gr') #
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice  & nonCE.tb$V11<1 ] )
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10<1 ] )
wilcox.test( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice  & coat.tb$V10<1 ],
nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11<1],
alternative='gr') #
head(nonCE.tb[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11 > 1,])
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ), ] )
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10<1 ), ] )
head(nonCE.tb[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11<1,])
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11 > 1 ] )
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ] )
wilcox.test( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ],
nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11 > 1],
alternative='gr')
nodechoice = 'internal'; cladechoice = 'bce';
BceClade
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10<1 ), ] )
head(nonCE.tb[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11<1,])
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice] )
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice] )
wilcox.test( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice],
nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice],
alternative='gr') #
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice  & nonCE.tb$V11<1 ] )
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10<1 ] )
wilcox.test( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice  & coat.tb$V10<1 ],
nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11<1],
alternative='gr') #
head(nonCE.tb[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11 > 1,])
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ), ] )
head(nonCE.tb[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11 > 1,], 10)
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ), ] )
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ), ], 10 )
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ), ], 10:20 )
head(coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ), ], 20 )
head(nonCE.tb[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11 > 1,], 10)
coat.tb[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ), ]
hist(coat.tb$V10[(coat.tb$node==nodechoice & coat.tb$flag==cladechoice)])
summary( nonCE.tb$V11[nonCE.tb$node==nodechoice & nonCE.tb$flag==cladechoice & nonCE.tb$V11 > 1 ] )
summary( coat.tb$V10[coat.tb$node==nodechoice & coat.tb$flag==cladechoice & coat.tb$V10 > 1 ] )
newtb = read.table("_free.omega.GBlocked.coat.paml.Jan17,2013.txt", sep="\t", header=F)
oldtb = read.table("_free.omega.coat.paml.Jan20,2011.txt", sep="\t", header=F)
rm(list=ls())
newtb = read.table("_free.omega.GBlocked.coat.paml.Jan17,2013.txt", sep="\t", header=F)
oldtb = read.table("_free.omega.coat.paml.Jan20,2011.txt", sep="\t", header=F)
head(newtb)
head(oldtb)
summary(newtb$V10)
summary(oldtb$V10)
summary(newtb$V14)
summary(lm(newtb$V10 ~ newtb$V14))
head(newtb)
summary(lm(newtb$V10 ~ newtb$V12))
summary(lm(newtb$V10 ~ newtb$V14))
plot( newtb$V10 ~ newtb$V14)
summary(lm(log10(newtb$V10) ~ log10(newtb$V14)))
summary(lm(log10(newtb$V10, na.rm=T) ~ log10(newtb$V14, na.rm=T)))
summary(oldtb$V10)
summary(oldtb$V14) #dS
summary(newtb$V14) #dS
newtb$V14[newtb$V14==0] = NA
#omega ~ dS
summary(lm(newtb$V10 ~ newtb$V14))
plot( newtb$V10 ~ newtb$V14)
summary(lm(log10(newtb$V10) ~ log10(newtb$V14)))
plot( log10(newtb$V10) ~ log10(newtb$V14))
summary(newtb$V12) #dN
newtb$V14[newtb$V12==0] = NA
summary(lm(log10(newtb$V10) ~ log10(newtb$V12)))
plot( log10(newtb$V10) ~ log10(newtb$V12))
summary(newtb$V12) #dN
summary(lm(log10(newtb$V10) ~ log10(newtb$V14)))
plot( log10(newtb$V10) ~ log10(newtb$V14))
#omega ~ dS
summary(lm(log10(newtb$V10) ~ log10(newtb$V14)))
plot( log10(newtb$V10) ~ log10(newtb$V14))
plot( log10(newtb$V10) ~ log10(newtb$V12))
plot( log2(newtb$V10) ~ log2(newtb$V12))
plot( log2(oldtb$V10) ~ log2(oldtb$V12))
summary(lm(log10(oldb$V10) ~ log10(oldtb$V14)))
summary(lm(log10(oldtb$V10) ~ log10(oldtb$V14)))
plot( log10(oldtb$V10) ~ log10(oldtb$V14))
### nonCE free omega
nonCE11.tb = read.delim("_nonCE.omega.7March2011.tab", header=F); #2011 results, without GBlocks
nonCE11.tb = nonCE11.tb[nonCE11.tb$V2=='H1C',] # H1C is where free omega are calculated
head(nonCE11.tb)
nonCE.tb = read.delim("_nonCE.omega.2013Jan23.tab", header=F); #20130123, after GBlocks
nonCE.tb$V1 = as.character( nonCE.tb$V1 )
nonCE.tb$V2 = as.character( nonCE.tb$V2 )
nonCE.tb = nonCE.tb[nonCE.tb$V2=='H1C',] # H1C is where free omega are calculated
nonCE.tb$V3 = as.character(nonCE.tb$V3)
nonCE.tb$node = "internal"
nonCE.tb$node[grep("^B", nonCE.tb$V3)] = "leaf"
head(nonCE.tb)
str(nonCE.tb)
head(nonCE.tb)
plot( log2(nonCE.tb$V11) ~ log2(nonCE.tb$V15))
head(nonCE.tb)
plot( log2(nonCE.tb$V11) ~ log2(nonCE.tb$V15))
#nonCE omega ~ dN, ?correlation
plot( log2(nonCE.tb$V11) ~ log2(nonCE.tb$V13))
#how many branch-omega are influenced by alignment, as indicated by GBlocks?
new.old.tb = merge(newtb[,c("V1","V2","w.new","BGbranch")], oldtb[,c("V1","V2","w.old","BGbranch")])
new.old.tb$new.vs.old = new.old.tb$w.new / new.old.tb$w.old
summary(new.old.tb)
hist( new.old.tb$new.vs.old[ new.old.tb$new.vs.old<3  ], br=100 )
myquants = quantile(new.old.tb$new.vs.old, prob= c(0.2, 0.25, 0.3, 0.4, 0.5, 0.6, 0.75, 0.8, 0.9))
# 2013 Jan 20, How does GBLOCKs affect omega, does it remove extremely high omegas, such as 9999?
newtb = read.table("_free.omega.GBlocked.coat.paml.Jan17,2013.txt", sep="\t", header=F)
oldtb = read.table("_free.omega.coat.paml.Jan20,2011.txt", sep="\t", header=F)
head(newtb)
head(oldtb)
summary(newtb$V10)
summary(oldtb$V10)
summary(lm(newtb$V10 ~ oldtb$V10))
#R=0.158, weak correlation? p<<0.001
plot( newtb$V10 ~ oldtb$V10 )
summary(lm(log10(newtb$V10) ~ log10(oldtb$V10)))
#R=0.307, weak correlation? p<<0.001
plot( log10(newtb$V10) ~ log10(oldtb$V10) )
#merge the two tables
newtb$BGbranch = paste( newtb[,1], newtb[,2] )
oldtb$BGbranch = paste( oldtb[,1], oldtb[,2] )
names1 = names(newtb)
names1[10]= "w.new"
names2 = names(oldtb)
names2[10]= "w.old"
names(newtb) = names1
names(oldtb) = names2
########################
#how many branch-omega are influenced by alignment, as indicated by GBlocks?
new.old.tb = merge(newtb[,c("V1","V2","w.new","BGbranch")], oldtb[,c("V1","V2","w.old","BGbranch")])
new.old.tb$new.vs.old = new.old.tb$w.new / new.old.tb$w.old
summary(new.old.tb)
hist( new.old.tb$new.vs.old[ new.old.tb$new.vs.old<3  ], br=100 )
myquants = quantile(new.old.tb$new.vs.old, prob= c(0.2, 0.25, 0.3, 0.4, 0.5, 0.6, 0.75, 0.8, 0.9))
head(newtb)
tmp = newtb$w.new
length( tmp[tmp>10]) / length(tmp)
