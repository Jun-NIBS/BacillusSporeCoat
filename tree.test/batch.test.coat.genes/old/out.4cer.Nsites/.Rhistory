#
rm(list=ls());#
 debug = 1;#
 cutoff=0.05; # for both p and q#
#
#### first, do lnL  #
 tb = read.table( "grep.lnL.txt", header=F, fill=T);#
 tb[,1] = as.character( tb[,1] );#
#
for( i in 1: (length( tb[,1] )/2) ) {#
  j = i * 2;#
  sub = tb[ c(j-1,j), ]#
  del = sub[2,5] - sub[1, 5];#
  p = pchisq( 2* del, df=1, lower.tail=F);#
  tb$p[j] = round( p, 4)#
  tb$p[j-1] = NA;#
}
tb
head(tb)
tb[tb$p<0.05, ]
tb
del = 1819.68 - 1821.6
del
  p = pchisq( 2* del, df=1, lower.tail=F);
p
del = -del
  p = pchisq( 2* del, df=1, lower.tail=F);
p
del = -1819.6755 + 1821.6185
del
  p = pchisq( 2* del, df=1, lower.tail=F);
p
 debug = 1;#
 cutoff=0.05; # for both p and q#
#
#### first, do lnL  #
 tb = read.table( "grep.lnL.txt", header=F, fill=T);#
 tb[,1] = as.character( tb[,1] );#
#
for( i in 1: (length( tb[,1] )/2) ) {#
  j = i * 2;#
  sub = tb[ c(j-1,j), ]#
  del = sub[2,5] - sub[1, 5];#
  #p = pchisq( 2* del, df=1, lower.tail=F); #062010, wrong, df should be 2#
  p = pchisq( 2* del, df=2, lower.tail=F); #062010, correct this error#
  tb$p[j] = round( p, 4)#
  tb$p[j-1] = NA;#
}
tb
