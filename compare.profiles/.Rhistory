?legened
?legend
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits");
legend(0,4, c( "Inner Coat", "Outer Coat" ))
legend(0,15, c( "Inner Coat", "Outer Coat" ))
# title(main="Comparison of orthologous distributions for inner and outer coat genes" )
#pdf( "barplotInOut2013Jan22.pdf" );
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits");
legend(0,15, c( "Inner Coat", "Outer Coat" ))
# title(main="Comparison of orthologous distributions for inner and outer coat genes" )
#dev.off();
#pdf( "barplotInOut2013Jan22.pdf" );
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits");
legend(0.5,15, c( "Inner Coat", "Outer Coat" ))
# title(main="Comparison of orthologous distributions for inner and outer coat genes" )
#dev.off();
?barplot
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits"
, legend = c( "Inner Coat", "Outer Coat" )
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(4,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(5,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(100,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(20,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(18,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(16,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus/Homologous Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(16,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(16,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologuus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(15,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Orthologus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(15,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of species with Orthologus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(15,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Bce species with Orthologus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(15,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Bce species with Orthologus Hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(15,0)
);
barplot( as.matrix(barInOut), beside=T, col=c("black","gray"), ylab="Counts", xlab="Number of Bce species with orthologus hits"
, legend = c( "Inner Coat", "Outer Coat" ), xlim = c(15,0)
);
View(profile)
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
col.palette = c("red","brown","blue","green");
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
rm( list = ls() );
library("e1071")
# numclus =4 ;
numclus =2 ; #111808 change
etb = read.table( "_essenGene.baciProfile.091208.csv",sep="\t",header=T);
ctb = read.csv( "_coat.profile.110808.csv");
bacillus.specs = names(ctb)[10:20];
### generate profile for coat genes
# ctb2 = cbind( rep("coat", length(ctb[,1])), ctb[, c(1,10:20) ]);
ctb2 = matrix( nrow=length(ctb[,1]), ncol=11);
colnames(ctb2) = bacillus.specs;
rownames(ctb2) = as.character( paste(ctb$id, ctb$Gene) );
for( j in 1:11){
for( i in 1:length(ctb2[,1]) ) {
#for( i in 1:2 ) {
ctb2[i,j] = ifelse( is.na(ctb[i,j+9]), 0, 1 );
}
}
head(ctb2);
ctb2 = ctb2[, -c(2,10,11)]
#check
head(ctb[,11:20]);
head(ctb2);
# ctb2["BG11380",]
#d.ham = as.dist( hamming.distance( ctb2 ) );
#hm, hamming distance and Euclidean distance is different for 3 genes?
mymethods = c("ward","complete","average","single","median","centroid", "mcquitty");
spec.colors = c("cyan","cyan","cyan","cyan","orange","orange","orange","orange" );
names(spec.colors) = c( "Bsu", "Bam", "Bli", "Bpu", "Ban", "Bce", "Bth", "Bwe")
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
col.palette = c("red","brown","blue","green");
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, ColSideColors = spec.colors,
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
col.palette = c("red","brown","blue","green"); #2013 Feb 9 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, ColSideColors = spec.colors,
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
col.palette = c("blue","red"); #2013 Feb 9 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#
RowSideColors=coat.color, ColSideColors = spec.colors,
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
#heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, ColSideColors = spec.colors,
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
# heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #bad plot
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, ColSideColors = spec.colors,
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
pdf("_20130209.average.hclust.2.coat.pdf", height=5, width=5);
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("red","brown","blue","green");
col.palette = c("blue","red"); #2013 Feb 9 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
#heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, ColSideColors = spec.colors,
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
dev.off();
pdf("_20130209.average.hclust.2.coat.pdf", height=5, width=5);
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("red","brown","blue","green");
col.palette = c("blue","red"); #2013 Feb 9 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
#heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
dev.off();
?heatmap
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("red","brown","blue","green");
col.palette = c("blue","red"); #2013 Feb 9 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
#heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
colors()
grep("blue", colors())
colors( grep("blue", colors()))
colors[(] grep("blue", colors())]
colors[grep("blue", colors())]
grep("blue", colors())
tmp = grep("blue", colors())
colors()[tmp]
col.palette = c("aliceblue","red"); #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
#heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
colors()[ grep("blue", colors()) ]
col.palette = c("blue1","red"); #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
#heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
col.palette = c("cladeblue","red"); #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
#heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("red","brown","blue","green");
#col.palette = c("blue","red"); #2013 Feb 9 change
col.palette = c("cladeblue","red"); #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
#heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
colors()[ grep("blue", colors()) ]
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("blue","red"); #2013 Feb 9 change
col.palette = c("cadetblue1","red"); #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
#heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
hmcol
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("blue","red"); #2013 Feb 9 change
col.palette = hmcol[c(1,16)]; #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("blue","red"); #2013 Feb 9 change
col.palette = hmcol[c(16,1)]; #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
pdf("_20130209.average.hclust.2.coat.pdf", height=17, width=17);
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("blue","red"); #2013 Feb 9 change
col.palette = hmcol[c(16,1)]; #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
dev.off();
pdf("_20130209.average.hclust.2.coat.pdf", height=7, width=7);
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("blue","red"); #2013 Feb 9 change
col.palette = hmcol[c(16,1)]; #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
dev.off();
pdf("_20130209.average.hclust.2.coat.pdf", height=5, width=5);
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("blue","red"); #2013 Feb 9 change
col.palette = hmcol[c(16,1)]; #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
dev.off();
?pdf
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
col.palette = c("red","brown","blue","green");
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, ColSideColors = spec.colors,
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
pdf("_111808.average.hclust.2.coat.pdf", height=5, width=5);
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
col.palette = c("red","brown","blue","green");
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, ColSideColors = spec.colors,
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
dev.off();
library(heatplus)
require(Heatplus);
heatmap_2(ctb2, do.dendro = c(TRUE, TRUE), legend = 1,
legfrac = 10,
hclustfun = function(c) hclust( c, method= mymethod),
col = hmcol
)
heatmap_2(ctb2, do.dendro = c(TRUE, TRUE), legend = 0,
legfrac = 10,
hclustfun = function(c) hclust( c, method= mymethod),
col = hmcol
)
hmcol
heatmap_2(ctb2, do.dendro = c(TRUE, TRUE), legend = 0, scale="none",
legfrac = 10,
hclustfun = function(c) hclust( c, method= mymethod),
col = hmcol
)
heatmap_2(ctb2, do.dendro = c(TRUE, TRUE), legend = 0, scale="none",RowSideColors=coat.color,
legfrac = 10,
hclustfun = function(c) hclust( c, method= mymethod),
col = hmcol
)
?heatmap_2
?grid
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
grid()
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
grid()
library(RColorBrewer);
hmcol = colorRampPalette(brewer.pal(5,"RdBu"))(16);
mymethod = "average";
hd =  hclust( dist(ctb2), mymethod);
coat.cat = cutree(hd, numclus )
#col.palette = c("blue","red"); #2013 Feb 9 change
col.palette = hmcol[c(16,1)]; #2013 Feb 17 change
coat.color = col.palette[coat.cat]
hcol =  hclust(dist( t(ctb2)), method=mymethod )
#hcol =  as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) )
heatmap( ctb2, col=hmcol, scale="none", margins = c(5,22),
#heatmap( ctb2, col=c("red","blue"), scale="none", margins = c(5,22),  #2013Feb9 change
#Colv = NA,  ## no dedrogram
#Colv = FALSE, ## use the input column order,
#Colv = as.dendrogram( hclust(dist( t(ctb2)), method=mymethod ) ),
RowSideColors=coat.color, # ColSideColors = spec.colors,  #2013Feb9, remove spec.colors
hclustfun = function(c) hclust( c, method=mymethod),
cexRow=0.4, cexCol=0.6 );
?heatmap
